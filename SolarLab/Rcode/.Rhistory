x<-seq(1,size)
dat<-data.frame(x,d=dbinom(x,size,dave),c=dbinom(x,size,carole))
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[1]))
g
library(ggplot2)
library(openintro)
data(COL)
dave<-0.7
carole<-0.6
size<-100
x<-seq(1,size)
dat<-data.frame(x,d=dbinom(x,size,dave),c=dbinom(x,size,carole))
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[7]))
g
library(ggplot2)
library(openintro)
data(COL)
dave<-0.7
carole<-0.6
size<-100
x<-seq(1,size)
dat<-data.frame(x,d=dbinom(x,size,dave),c=dbinom(x,size,carole))
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[22]))
g
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[1],fill=COL[1]))
g
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[2],fill=COL[2]))
g
g<-ggplot(data=dat,aes(x=x))+geom_bar(stat="bin",aes(width=0.4,col = COL[2],fill=COL[2]))
g
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="bin",aes(width=0.4,col = COL[2],fill=COL[2]))
g
library(ggplot2)
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[2],fill=COL[2]))
g
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,col = COL[7],fill=COL[7]))
g
?COL()
g<-ggplot(data=dat,aes(x=x,y=d))+geom_bar(stat="identity",aes(width=0.4,colour = COL[7],fill=COL[7]))
g
g<-ggplot(data=dat,aes(x=x,y=d,fill=COL[7]))+geom_bar(stat="identity",aes(width=0.4,colour = COL[7],fill=COL[7]))
g
g<-ggplot(data=dat,aes(x=x,y=d,fill=COL[7]))+geom_bar(stat="identity",aes(width=0.4,colour = COL[7]))
g
g<-ggplot(data=dat,aes(x=x,y=d,fill=COL[7]))+geom_bar(stat="identity",aes(width=0.4,colour = COL[7],alpha=0.5))
g
g<-ggplot(data=dat,aes(x=x,y=d,fill=COL[7]))+geom_bar(stat="identity",aes(width=0.4,colour = COL[7],alpha=0.3))
g
?Rmarkdown
?markdown
knit_engines$set()
?cat
qnorm(-3.7,0,1.7)
pnorm(-3.7,0,1.7)
?swirl
install.packages("swirl")
library(swirl)
ls()
rm(list=ls())
ls()
swirl()
?InstallCourses
install_from_swirl(Getting and Cleaning Data, dev = FALSE, mirror = "github")
install_from_swirl(Getting_and_Cleaning_Data, dev = FALSE, mirror = "github")
SWIRL()
swirl()
7/(200000/10000)
7/(10000/200000)
setwd("H:/Rspace/RE_Community/SolarLab/Rcode")
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (file in file_handles){
fullname<-paste0(path,file_handles[file])
data<-readRDS("fullname)
}
}
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (file in file_handles){
fullname<-paste0(path,file_handles[file])
data<-readRDS("fullname)
}
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (file in file_handles){
fullname<-paste0(path,file_handles[file])
data<-readRDS(fullname)
}
for (file in file_handles){
fullname<-paste0(path,file_handles[file])
print (fullname)
data<-readRDS(fullname)
}
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (file in 1:length(file_handles){
fullname<-paste0(path,file_handles[file])
print (fullname)
data<-readRDS(fullname)
}
file_handles
for (i in 1:length(file_handles){
fullname<-paste0(path,file_handles[i])
print (fullname)
data<-readRDS(fullname)
}
file_handles[1]
paste0(path,file_handles[1])
length(file_handles)
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (i in 1:length(file_handles){
fullname<-paste0(path,file_handles[i])
print (fullname)
data<-readRDS(fullname)
}
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (i in 1:length(file_handles)){
fullname<-paste0(path,file_handles[i])
print (fullname)
data<-readRDS(fullname)
}
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (file in 1:length(file_handles)){
fullname<-paste0(path,file_handles[file])
print (fullname)
data<-readRDS(fullname)
}
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
table(data$bin)
length(data$bin)
nrow(data)
maxBin
dim(tpm)
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
dim(tpm)
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
bins
dim(cpm)
bins
dim(tpm)
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
length(bins)
tpm[1,]
summary(tpm)
#print(tpm)
sum(tpm[1,])
# sums of each row of TPM
for (i in 1 :nrow(tpm)){
spm[i]=sum(tpm[i,])
}
spm
sum(spm)
tpmr<-tpm
count=0
bins<-seq(1,maxBin)
for (i in 1 :nrow(tpm)){
if (sum(tpm[i,])==0) {
bins<-bins[-(i-count)]
tpmr<-tpmr[-(i-count),]
tpmr<-tpmr[,-(i-count)]
count=count+1
}
}
str(tpmr)
bins
maxBin<-max(bins)
spm<-numeric(nrow(tpmr))
# sums of each row of TPMr
for (i in 1 :nrow(tpmr)){
spm[i]=sum(tpmr[i,])
}
spm
sum(spm)
tpmp<-tpmr
# TPM as probabilities
for (i in 1 :nrow(tpmr)){
tpmp[i,]=tpmr[i,]/spm[i]
}
sum(tpmp)
cpm<-tpmp
# TPM-> CPM: cumulative probabilities
for (i in 1 : nrow(tpmp)){
for (j in 1 :ncol(tpmp)){
cpm[i,j]=sum(tpmp[i,1:j])
}
}
dim(cpm)
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
tpm[1,]
summary(tpm)
#print(tpm)
sum(tpm[1,])
spm<-numeric(maxBin)
# sums of each row of TPM
for (i in 1 :nrow(tpm)){
spm[i]=sum(tpm[i,])
}
spm
sum(spm)
tpmr<-tpm
count=0
bins<-seq(1,maxBin)
for (i in 1 :nrow(tpm)){
if (sum(tpm[i,])==0) {
bins<-bins[-(i-count)]
tpmr<-tpmr[-(i-count),]
tpmr<-tpmr[,-(i-count)]
count=count+1
}
}
str(tpmr)
bins
maxBin<-max(bins)
spmr<-numeric(nrow(tpmr))
# sums of each row of TPMr
for (i in 1 :nrow(tpmr)){
spmr[i]=sum(tpmr[i,])
}
spmr
sum(spmr)
tpmp<-tpmr
# TPM as probabilities
for (i in 1 :nrow(tpmr)){
tpmp[i,]=tpmr[i,]/spmr[i]
}
sum(tpmp)
cpm<-matrix(0, nrow = maxBin, ncol =maxBin)
cpm<-tpmp
# TPM-> CPM: cumulative probabilities
for (i in 1 : nrow(tpmp)){
for (j in 1 :ncol(tpmp)){
cpm[i,j]=sum(tpmp[i,1:j])
}
}
dim(cpm)
maxBin
maxBin<-max(bins)
maxBin
dim(tpmp)
dim(tpm)
dim(tpmr)
tpm[1,]
summary(tpm)
#print(tpm)
sum(tpm[1,])
spm<-numeric(maxBin)
# sums of each row of TPM
for (i in 1 :nrow(tpm)){
spm[i]=sum(tpm[i,])
}
spm
sum(spm)
tpmr<-tpm
count=0
bins<-seq(1,maxBin)
for (i in 1 :nrow(tpm)){
if (sum(tpm[i,])==0) {
bins<-bins[-(i-count)]
tpmr<-tpmr[-(i-count),]
tpmr<-tpmr[,-(i-count)]
count=count+1
}
}
str(tpmr)
bins
tpmr[100,]
tpmr[,100]
count
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
rm(list=ls())
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
View(cpm)
plot(cpm)
cplot(cpm)
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
sum(swd)/sum(Q)
sum(swd)/sum(data$SWD[daybegin:dayend])
sum(data$SWD[daybegin:dayend])/sum(Q)
daybegin
dayend
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
srss
368 % 365
368 %% 365
365 %% 365
data<-readRDS("../data/cleaned/Cam2002n.csv")
# sunrise and sunset times
srss<-read.csv("../data/h0times.csv",sep=",")
str(srss)
srss$sunrise<-as.integer(srss$sunrise)
srss$sunset<-as.integer(srss$sunset)
# cpm matrix for given location
cpm<-read.table("../tpm/Cam_cpm.csv",sep=",")
# first column is the bins,so separate that off
#cpm[1,]<-NULL
bins<-cpm[,1]
cpm[,1]<-NULL
phi=(pi/180)*50
S0=1200
#Stochastic generation of synthetic data
perday<-1440
mdays<-c(31,28,31,30,31,30,31,31,30,31,30,31)
cmdays<-c(0,cumsum(mdays)[1:11])
permonth<-mdays*perday
maxlim<-10
day1<-1
dayspan<-365
daybegin<-1+(day1-1)*perday
dayend<-(day1+dayspan-1)*perday
datrange<-range(data$SWD[daybegin:dayend])[2]
t=seq(daybegin,dayend)
Q<-solarFlux(S0,phi,t/perday)
v<-rep(0,(length(t)))
swd<-rep(0,(length(t)))
for (k in day1:(day1+dayspan-1)){
rmean<-ifelse(k < 90 | k > 270,0.39,0.55)
rsd<-ifelse(k < 90 | k > 270,0.4,0.2)
#cat(k," ")
dbegin<-1+(k-1)*perday
dend<-k*perday
for(minute in dbegin:srss$sunrise[k]){
swd[minute-daybegin]=0
}
for(minute in srss$sunset[k]:dend){
swd[minute-daybegin]=0
}
v[srss$sunrise[k]+1]<-90#round((nrow(cpm)-1)*runif(1),0)+1#ifelse(k==1,round((nrow(cpm)-1)*runif(1),0)+1,v[srss$sunset[k-1]-1])
mincount=0
maxcount=0
for (i in (srss$sunrise[k]+2):srss$sunset[k]){
colIndex=min(1,max(0.1,rnorm(1,0,rsd)+rmean))
j=1
while (cpm[v[i-1],j] < colIndex){
j=j+1
}
v[i]=j
#         if (j==1 && v[i-1]==1) mincount=mincount+1
#         if (j==max(bins) && v[i-1]==max(bins) ) maxcount =maxcount+1
#         if (mincount == maxlim | maxcount == maxlim){
#             print(paste("maxlim reached: min= ",mincount," max= ",maxcount))
#             v[i]=max(bins)/2
#             mincount=0
#             maxcount=0
#         }
#v[i]=min(j,nrow(cpm))
#v[i]=max(1,j)
Qnow<-solarFlux(S0,phi,i/perday)
swd[i-daybegin]<-(v[i]/max(bins))*Qnow #*datrange)
}
#cat(k,":",round(v[i-1],0),j," ")
cat (k,",",bins[v[i]],": ",sep="")
}
sum(swd)/sum(Q)
sum(swd)/sum(data$SWD[daybegin:dayend])
sum(data$SWD[daybegin:dayend])/sum(Q)
months<-dayend/(30*perday)
simtotal=0
meastotal=0
for (i in 1:months) {
monthbegin<-cmdays[i]*perday+1
monthend<-(cmdays[i]+mdays[i])*perday
simtotal<-simtotal+sum(swd[monthbegin:monthend])
meastotal<-meastotal+sum(data$SWD[monthbegin:monthend])
monthratio<-sum(swd[monthbegin:monthend])/sum(data$SWD[monthbegin:monthend])
print(paste(i,": ",monthbegin,monthend,round(monthratio,2),round(simtotal/meastotal,2)))
}
sum(data$SWD[daybegin:dayend])/(60*1000)
sum(swd)/(60*1000)
summary(swd[swd>0])
hist(swd[swd>0],breaks=50)
summary(data$SWD[data$SWD>0])
hist(data$SWD[data$SWD>0],breaks=50)
# plot(t/1440,Cam2001n$SWD[daybegin:dayend],type="l",ylim=c(0,1500))
# lines(t/1440,swd,type="l",col="blue")
# lines(t/1440,Q,type="l",col="red")
#day<-183
for (day in seq(day1,(day1+dayspan-1),by=3)){
start<-srss[day,2]
end<-srss[day,3]
ymax<-max(max(Q[start:end]),max(data$SWD[start:end]))
plot(t[start:end]/perday,data$SWD[start:end],type="l",ylim=c(0,ymax))
lines(t[start:end]/perday,swd[start:end],type="l",col="blue")
lines(t[start:end]/perday,Q[start:end],type="l",col="red")
}
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
?runmean
?caTools
library(caTools)
?runmean
library (dplyr)
file_handles<-c("Cam2001n.csv","Cam2002n.csv")
path<-"../data/cleaned/"
for (file in 1:length(file_handles)){
fullname<-paste0(path,file_handles[file])
#print (fullname)
data<-readRDS(fullname)
data$test<-data$datetime %% 10
print (maxBin)
}
str(data)
?POSIXct
data$test<-data$datetime
data$test$min<-data$test$min %% 10
summary(data$test)
data$test<-as.POSIXlt(data$datetime)
str(data$test)
summary(data$test$min)
data$test$min<-data$test$min %% 10
table (data$test$min)
59 %% 10
?%%
?"%%"
59 %/% 10
19 %/% 10
data$test$min<-10*(data$test$min %/% 10)
table(data$test$min)
data$test<-as.POSIXlt(data$datetime)
data$test$min<-10*(data$test$min %/% 10)
table(data$test$min)
str(data)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(data)
summary(data)
head(data)
data$datetime[1:20]
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(data)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(newdata)
newdata<-group_by(data, datetime)
str(newdata)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(newdata)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(newdata)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(newdata)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(data)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
str(newdata)
source('H:/Rspace/RE_Community/SolarLab/Rcode/min1_to_min10.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
123 %/% 10
t<-10*(t %/% 10)
newdata<-cbind(t,swd)
names(newdata)<-c("minutes","swd")
newdata<-newdata %>% group_by(minutes) %>% summarise_each(funs(mean))
newname<-paste0(path,file_handles[file],"10min",".csv")
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
head(t)
tail(t)
head(t,25)
library(dplyr)
t<-10*(t %/% 10)
newdata<-cbind(t,swd)
names(newdata)<-c("minutes","swd")
newdata %>% group_by(minutes) %>% summarise_each(funs(mean))
class(newdata)
newdata<-as.data.frame(cbind(t,swd))
names(newdata)<-c("minutes","swd")
newdata %>% group_by(minutes) %>% summarise_each(funs(mean))
summary(newdata)
str(newdata)
str(data)
newname<-paste0(path,file_handles[file],"10min",".csv")
newname
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R')
spm
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
srss
colindex=runif(1)
source('H:/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R')
summary(swd[swd>0])
hist(swd[swd>0],breaks=50)
summary(data$SWD[data$SWD>0])
hist(data$SWD[data$SWD>0],breaks=50)
head(t)
t=seq(daybegin,dayend)
head(t)
library(dplyr)
newdata<-as.data.frame(cbind(t,swd))
names(newdata)<-c("minutes","swd")
write.csv(newdata,"../data/synthetic/Cam001_1min.csv")
t10<-10*(t %/% 10)
newdata<-as.data.frame(cbind(t10,swd))
names(newdata)<-c("minutes","swd")
newdata %>% group_by(minutes) %>% summarise_each(funs(mean))
write.csv(newdata,"../data/synthetic/Cam001_10min.csv")
new10<-newdata %>% group_by(minutes) %>% summarise_each(funs(mean))
write.csv(new10,"../data/synthetic/Cam001_10min.csv")
source('H:/Rspace/RE_Community/SolarLab/Rcode/GetAndCleanData2002.R')
