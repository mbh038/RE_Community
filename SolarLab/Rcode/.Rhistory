for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main=N)
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main="N=",N,"p=",p)
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main=paste("N=",N," p=",p))
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main=paste("N=",N," p=",p))
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
library(rafalib)
mypar2(4,5)
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
LIM <- range(c(approx,exact))
plot(exact,approx,main=paste("N =",N," p = ",p),xlim=LIM,ylim=LIM,col=1,pch=16)
abline(0,1)
}
}
mypar(4,5)
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
library(rafalib)
mypar(4,5)
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
LIM <- range(c(approx,exact))
plot(exact,approx,main=paste("N =",N," p = ",p),xlim=LIM,ylim=LIM,col=1,pch=16)
abline(0,1)
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
#library(rafalib)
mypar(4,5)
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
LIM <- range(c(approx,exact))
plot(exact,approx,main=paste("N =",N," p = ",p),xlim=LIM,ylim=LIM,col=1,pch=16)
abline(0,1)
}
}
library(devtools)
install_github("genomicsclass/dagdata")
library(dagdata)
data(hcmv)
library(rafalib)
mypar()
plot(locations,rep(1,length(locations)),ylab="",yaxt="n")
breaks=seq(0,4000*round(max(locations)/4000),4000)
tmp=cut(locations,breaks)
counts=as.numeric(table(tmp))
hist(counts)
probs <- dpois(counts,4)
likelihood <- prod(probs)
likelihood
?prod
logprobs <- dpois(counts,4,log=TRUE)
loglikelihood <- sum(logprobs)
loglikelihood
?dpois
$\tiny{2}\\small{4}\large{8}\huge{16}$
?randomForest
library(randomForest)
?randomForest
.99*.04
.99*.96
.008+.002+.9504+.0396
.008+.9504
.008/0.9504
mean(9.0,9.8,10.1)
?mean
mean(c(9.0,9.8,10.1))
T<-c(9.0,9.8,10.1)
mean(T)
T2<-c(9.0,10.9,9.4,10.9,9.8,9.9,10.6,9.1)
T2
length(T2)
mean(T2)
T3<-c(9.0,10.9,9.4,10.9,9.8,9.9,10.6,9.1,9.3,10.1,9.7,9.6,9.2,10.7,11.0,11.5,9.8,8.9,11.2,10.0)
table(T3)
length(T3)
mean(T3)
Tw<-c(0,2,4,6,8,10)
rhoSW<-c(1031.364,1031.205,1030.997,1030.763,1030.445,1030.106)
plot(Tw,rhoSW,type="b")
Tw<-c(0,2,4,6,8,10)
rhoSW<-c(1031.364,1031.205,1030.997,1030.763,1030.445,1030.106)
plot(Tw,rhoSW,type="b")
vSW<-1/rhoSW
vSW
Tw<-c(0,2,4,6,8,10)
rhoSW<-c(1031.364,1031.205,1030.997,1030.763,1030.445,1030.106)
vSW<-1/rhoSW
sw<-data.frame(Tw,rhoSW,vSW)
names(sw)<-c("T","density","v")
plot(sw
plot(sw$T,sw$density,type="b",col="blue")
plot(sw$T,sw$density,type="b",col="blue",xlab="Temperature (C)",ylab="density kg/m3")
sw[sw$T==8,v]
sw[sw$T==8,sw$v]
v8<-sw[sw$T==8,sw$v]
v8
sw
v8<-sw[sw$T=8,sw$v]
v8
v8<-sw[which(sw$T==8),sw$v]
v8
v8
sw
sw[which(sw$T==8),sw$v]
?sw
sw[which(sw$T==8),]
sw[which(sw$T==8),3]
v8<-sw[which(sw$T==8),3]
v4<-sw[which(sw$T==4),3]
100*(v8-v4)/v4
v8<-sw[which(sw$T==8),3]
v4<-sw[which(sw$T==4),3]
dv<-100*(v8-v4)/v4
dv
v8<-sw[which(sw$T==8),3]
v4<-sw[which(sw$T==4),3]
dv<-(v8-v4)/v4
dv
4000*dv
vIce<-2.85e15 #m3
rhoIce<-916.9 #kg/m3
mIce<-vIce*rhoIce
vIce<-2.85e15 #volume of ice m3
rhoIce<-916.9 #density of ice kg/m3
mIce<-vIce*rhoIce # mass of ice
rhoWater<-1000 # density of water kg/m3
vMeltWater<-mIce/rhoWater # volume of melt water
aOcean<-0.7*4*pi*(6300e3)^2 # area of oceans
dh<-vMeltWater/aOcean # increase in sea level
dh
tau<-55
C88<-1
Ct<-function(t,tau,C0){
C0*exp(-t/tau)
}
t<-tau*log(0.2)
t
Ct(t,tau,1)
tau<-55
C88<-1
Ct<-function(t,tau,C0){
C0*exp(-t/tau)
}
t<-tau*log(0.2)
t
Ct(t,tau,1)
tau<-55
C88<-1
Ct<-function(t,tau,C0){
C0*exp(-t/tau)
}
t<--tau*log(0.2)
t
Ct(t,tau,1)
tau<-55
C88<-1
Ct<-function(t,tau,C0){
C0*exp(-t/tau)
}
dt<--tau*log(0.2)
dt
Ct(dt,tau,1)
dt+1988
Ct(dt,140,1)
CFC11_tau<-55
CFC11_rf<-1.0 # Wm-2 per Tg
CFC11_gwp100<-4750
CFC12_tau<-140
CFC12_rf<-1.5 # Wm-2 per Tg
(CFC12_tau/CFC11_tau)
CFC11_tau<-55
CFC11_rf<-1.0 # Wm-2 per Tg
CFC11_gwp100<-4750
CFC12_tau<-140
CFC12_rf<-1.5 # Wm-2 per Tg
(CFC12_tau/CFC11_tau)*(exp(-100/CFC12_tau)-1)/(exp(-100/CFC11_tau)-1)
CFC11_tau<-55
CFC11_rf<-1.0 # Wm-2 per Tg
CFC11_gwp100<-4750
CFC12_tau<-140
CFC12_rf<-1.5 # Wm-2 per Tg
# average concentration ratio over 100 years
c12c11ratio<-(CFC12_tau/CFC11_tau)*(exp(-100/CFC12_tau)-1)/(exp(-100/CFC11_tau)-1)
CFC12_gwp100<-CFC11_gwp100*c12c11ratio*CFC12_rf/CFC11_rf
CFC12_gwp100
$$C=C_0 \exp\left(\frac{-t}{\tau}\right)$$
setwd("C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode")
acos(tan(phi)*tan(deltaOdot(t)))
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
cpm
hist(v)
hist(Q)
bins
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
#Generates a tpm and cpm matric from actual solar data.
# Load cleaned data
########################################################################
Cam2001n<-readRDS("../data/cleaned/Cam2001n.csv")
# Markov Chain
########################################################################
reference<-data.frame(Cam2001n$datetime,Cam2001n$SWD)
names(reference)<-c("datetime","SWD")
reference<-reference[reference$SWD>0,]
# log transform the data
reference$SWD<-(reference$SWD)
reference$SWD[reference$SWD=="-Inf"]=0
SWDrange<-range(reference$SWD)
# bin into 10 levels
reference$bin<-floor((reference$SWD/max(reference$SWD))*9.999)+1
table(reference$bin)
sum(table(reference$bin))
hist(reference$bin)
maxBin=max(reference$bin)
tpm<-matrix(0, nrow = maxBin, ncol =maxBin)
spm<-numeric(maxBin)
cpm<-matrix(0, nrow = maxBin, ncol =maxBin)
# loop to generate TPM counts
for (i in 1:(nrow(reference)-1)){
tpm[reference$bin[i],reference$bin[i+1]] <-tpm[reference$bin[i],reference$bin[i+1]] + 1
}
tpm[1,]
summary(tpm)
#print(tpm)
sum(tpm[1,])
# sums of each row of TPM
for (i in 1 :nrow(tpm)){
spm[i]=sum(tpm[i,])
}
spm
sum(spm)
tpmr<-tpm
count=0
bins<-seq(1,maxBin)
for (i in 1 :nrow(tpm)){
if (sum(tpm[i,])==0) {
bins<-bins[-(i-count)]
tpmr<-tpmr[-(i-count),]
tpmr<-tpmr[,-(i-count)]
count=count+1
}
}
str(tpmr)
bins
spm<-numeric(nrow(tpmr))
# sums of each row of TPMr
for (i in 1 :nrow(tpmr)){
spm[i]=sum(tpmr[i,])
}
spm
sum(spm)
tpmp<-tpmr
# TPM as probabilities
for (i in 1 :nrow(tpmr)){
tpmp[i,]=tpmr[i,]/spm[i]
}
sum(tpmp)
cpm<-tpmp
# TPM-> CPM: cumulative probabilities
for (i in 1 : nrow(tpmp)){
for (j in 1 :ncol(tpmp)){
cpm[i,j]=sum(tpmp[i,1:j])
}
}
cpm<-cbind(bins,cpm)
write.table(cpm,"../tpm/Cam2001cpm.csv",sep=",",row.names=FALSE,col.names=FALSE)
bins
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarTPM.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
sum(Cam2001n$SWD[daybegin:dayend])/(60*1000)
sum(swd)/(60*1000)
?rnorm
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
min(1,max(0,rnorm(100,0,0.25)+0.5))
min(1,max(0,rnorm(100,0,0.25)+0.5))
min(1,max(0,rnorm(100,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
min(1,max(0,rnorm(1,0,0.25)+0.5))
a<-rnorm(100,0,0.25)+0.5
a
hist(a)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
max(bins)
hist(rnorm(1000,0,0.25))
?&&
ncol(cpm)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
round(v[50-1],0)
hist(v)
head(srss)
round(v[700-1],0)
v[700:800]
round(v[700:800],0)
summary(cpm[1,])
cpm[1,]
cpm[50,]
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
permonth<-30*perday
months<-dayend/permonth
months
months<-dayend/permonth
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
print(paste(monthbegin," ",monthend))
}
months<-dayend/permonth
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
print(paste(i,": ",sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])))
}
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
469/605
5.12/6
daybegin
dayend
length(swd)
months<-dayend/permonth
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
print(paste(i,": ",monthbegin,monthend,sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])))
}
sum(swd)/sum(Cam2001n$SWD[daybegin:dayend])
months<-dayend/permonth
total=0
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
monthratio<-sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
print(paste(i,": ",monthbegin,monthend,monthratio))
}
months<-dayend/permonth
total=0
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
monthratio<-sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
total=(total+monthratio)/i
print(paste(i,": ",monthbegin,monthend,monthratio,total))
}
months<-dayend/permonth
total=0
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
monthratio<-sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
total=total+monthratio
print(paste(i,": ",monthbegin,monthend,monthratio,total/i))
}
sum(swd)/sum(Cam2001n$SWD[daybegin:dayend])
months<-dayend/permonth
total=0
simtotal=0
meastotal=0
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
simtotal<-simtotal+sum(swd[monthbegin:monthend])
meastotal<-meastotal+sum(Cam2001n$SWD[monthbegin:monthend])
monthratio<-sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
total=total+monthratio
print(paste(i,": ",monthbegin,monthend,monthratio,total/i,simtotal/meastotal))
}
sum(Cam2001n$SWD[daybegin:dayend])
meastotal
sum(swd)
simtotal
months<-dayend/permonth
simtotal=0
meastotal=0
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
simtotal<-simtotal+sum(swd[monthbegin:monthend])
meastotal<-meastotal+sum(Cam2001n$SWD[monthbegin:monthend])
monthratio<-sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
print(paste(i,": ",monthbegin,monthend,monthratio,simtotal/meastotal))
}
months<-dayend/permonth
simtotal=0
meastotal=0
for (i in 1:months) {
monthbegin<-(i-1)*permonth+1
monthend<-i*permonth
simtotal<-simtotal+sum(swd[monthbegin:monthend])
meastotal<-meastotal+sum(Cam2001n$SWD[monthbegin:monthend])
monthratio<-sum(swd[monthbegin:monthend])/sum(Cam2001n$SWD[monthbegin:monthend])
print(paste(i,": ",monthbegin,monthend,round(monthratio,2),round(simtotal/meastotal,2)))
}
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
source('C:/Users/Mike/Rspace/RE_Community/SolarLab/Rcode/SolarMarkov.R', echo=TRUE)
rm(list=ls())
