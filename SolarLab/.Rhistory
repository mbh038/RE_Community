a<-(350 - 1000*.4)/sqrt(1000*.4*.6)
normApprox<-pnorm(b)-pnorm(a)
exact-normApprox
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
for (N in Ns){
2*N
}
probs=data.frame(c("exact","approx"))
probs=data.frame("exact","approx")
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs=data.frame("exact","approx")
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=rbind(probs,c(exact,approx))
}
}
probs
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=rbind(probs,c(exact,approx))
}
}
probs
N<-6
k<-seq(1,N-1)
k
N<-5
p<-0.01
k<-seq(1,N-1)
k
exact = dbinom(k,N,p)
exact
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=rbind(probs,c(exact,approx))
approx
probs
probs<-data.frame(exact=numeric(),approx=numeric())
probs
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=rbind(probs,c(exact,approx))
probs
probs=cbind(exact,approx)
probs
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx)
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx)
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main=N)
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main="N=",N,"p=",p)
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main=paste("N=",N," p=",p))
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
probs<-data.frame(exact=numeric(),approx=numeric())
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
probs=cbind(exact,approx)
plot(exact,approx,main=paste("N=",N," p=",p))
abline(0,1,col="red")
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
library(rafalib)
mypar2(4,5)
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
LIM <- range(c(approx,exact))
plot(exact,approx,main=paste("N =",N," p = ",p),xlim=LIM,ylim=LIM,col=1,pch=16)
abline(0,1)
}
}
mypar(4,5)
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
library(rafalib)
mypar(4,5)
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
LIM <- range(c(approx,exact))
plot(exact,approx,main=paste("N =",N," p = ",p),xlim=LIM,ylim=LIM,col=1,pch=16)
abline(0,1)
}
}
Ns <- c(5,10,30,100)
ps <- c(0.01,0.10,0.5,0.9,0.99)
#library(rafalib)
mypar(4,5)
for (N in Ns){
k<-seq(1,N-1)
for (p in ps){
exact = dbinom(k,N,p)
a <- (k+0.5 - N*p)/sqrt(N*p*(1-p))
b <- (k-0.5 - N*p)/sqrt(N*p*(1-p))
approx = pnorm(a) - pnorm(b)
LIM <- range(c(approx,exact))
plot(exact,approx,main=paste("N =",N," p = ",p),xlim=LIM,ylim=LIM,col=1,pch=16)
abline(0,1)
}
}
library(devtools)
install_github("genomicsclass/dagdata")
library(dagdata)
data(hcmv)
library(rafalib)
mypar()
plot(locations,rep(1,length(locations)),ylab="",yaxt="n")
breaks=seq(0,4000*round(max(locations)/4000),4000)
tmp=cut(locations,breaks)
counts=as.numeric(table(tmp))
hist(counts)
probs <- dpois(counts,4)
likelihood <- prod(probs)
likelihood
?prod
logprobs <- dpois(counts,4,log=TRUE)
loglikelihood <- sum(logprobs)
loglikelihood
?dpois
$\tiny{2}\\small{4}\large{8}\huge{16}$
?randomForest
library(randomForest)
?randomForest
.99*.04
.99*.96
.008+.002+.9504+.0396
.008+.9504
.008/0.9504
##
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-S0*cosTheta(phi,delta,h)
flux<-pmax(flux,rep(0,length(t)))
flux
}
#####################################################################
library(lubridate)
Cam2001<- read.table("./data/project_label_BSRN_event_label_CAM_2001.tab",sep="\t", header=TRUE,stringsAsFactors=FALSE)
str(Cam2001)
names(Cam2001)<-c("datetime","DIF","LWD","SWD","DIR","ORG")
# convert time to POSIXct
Cam2001$Date.Time<-ymd_hms(Cam2001$datetime)
attach(Cam2001)
Npoint<-7*1440
plot(SWD[1:Npoint],type="l")
setwd("C:/Users/Mike/Rspace/RE_Community/SolarLab")
##
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-S0*cosTheta(phi,delta,h)
flux<-pmax(flux,rep(0,length(t)))
flux
}
#####################################################################
library(lubridate)
Cam2001<- read.table("./data/project_label_BSRN_event_label_CAM_2001.tab",sep="\t", header=TRUE,stringsAsFactors=FALSE)
str(Cam2001)
names(Cam2001)<-c("datetime","DIF","LWD","SWD","DIR","ORG")
# convert time to POSIXct
Cam2001$Date.Time<-ymd_hms(Cam2001$datetime)
attach(Cam2001)
Npoint<-7*1440
plot(SWD[1:Npoint],type="l")
day<-120
phi=(pi/180)*50
S0=1368
t=seq(1,366,length.out=365*1440)
daybegin<-day*1440
dayend<-(day+7)*1440
Q<-solarFlux(S0,phi,t)
plot(SWD[daybegin:dayend],type="l",ylim=c(0,1500))
lines(Q[daybegin:dayend],type="l",col="blue")
# declination angle
deltaOdot<-function(t){
# t is the time in day number 1-365
#t<-t*365
asin(sin(-0.4091)*cos((2*pi/365.24)*(t+10)+0.0334*sin((2*pi/365.24)*(t-2))))
}
h0<-function(phi,t){
acos(tan(phi)*tan(deltaOdot(t)))
}
cosTheta<-function(phi,delta,h){
# theta is the zenith angle
sin(phi)*sin(delta)+cos(phi)*cos(delta)*cos(h)
}
solarFlux<-function(S0,phi,t){
h<-pi*(2*(t-floor(t))-1)
delta<-deltaOdot(t)
flux<-S0*cosTheta(phi,delta,h)
flux<-pmax(flux,rep(0,length(t)))
flux
}
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*h0s/pi,type="l")
day<-180
phi=(pi/180)*50
S0=1368
t=seq(1,366,length.out=365*288)
daybegin<-day*288
dayend<-(day+1)*288
Q<-solarFlux(S0,phi,t)
plot(t[daybegin:dayend],Q[daybegin:dayend],type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*h0s/pi,type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,h0s,type="l")
h0(0,180)
day<-180
phi=(pi/180)*0
S0=1368
t=seq(1,366,length.out=365*288)
daybegin<-day*288
dayend<-(day+1)*288
Q<-solarFlux(S0,phi,t)
plot(t[daybegin:dayend],Q[daybegin:dayend],type="l")
phi=(pi/180)*0
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,h0s,type="l")
library(png)
library(grid)
img <- readPNG("figures/solarZenithAngle.png")
grid.raster(img)
phi=(pi/180)*0
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*(h0s+pi)/(2*pi),type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*(h0s+pi)/(2*pi),type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/(2*pi),type="l")
phi=(pi/180)*50
t=seq(1,365,length.out=365*288)
plot(t,180*deltaOdot(t)/pi,typ="l",ylab="delta")
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
seq(10,90,10)
t=seq(1,365,length.out=365*288)
phi=(pi/180)*
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,90,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,90,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,80,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,60,7)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,60,7)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(10,60,7)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(50,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
seq(50,60,10)
phi=(pi/180)*lat
phi
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
summary(h0s)
plot(h0s)
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l")
for (lat in seq(50,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l",ylim=c(0,24))
for (lat in seq(50,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l",ylim=c(0,24))
for (lat in seq(10,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l",ylim=c(0,24))
for (lat in seq(10,70,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=365*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l",ylim=c(0,24))
for (lat in seq(10,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
t=seq(1,365,length.out=360*288)
phi=(pi/180)*0.01
h0s<-h0(phi,t)
plot(t,24*(pi-h0s)/pi,type="l",ylim=c(0,20))
for (lat in seq(10,60,10)){
phi=(pi/180)*lat
h0s<-h0(phi,t)
lines(t,24*(pi-h0s)/pi,type="l",col=lat/10)
}
